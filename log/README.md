# 异步日志系统

- 数据结构：循环双向链表，便于扩展


**优化：**  
----------------------------------
- 每次记录日志都会去获取时间，当线程数量很多的时候，这会影响到性能，优化：不用每次都更新时间，只有当时间超过一分钟时才刷新整个时间缓冲区。

**TODO**  
------------------------------
- 测试发现如果程序异常退出，会导致内存中的部分日志丢失。共享内存解决？

**Problem**
------------------------------
- 测试时发现在主循环中调用chttp的write函数时，有错误。但是根据日志不知道具体位置，然后想根据coredump文件来查找问题
  但是wsl生成coredump文件较难，参考资料较少。就利用虚拟机来测试，[link](https://blog.csdn.net/qq_15328161/article/details/109085705)
  问题出在修改timer时间的时候先删除timer后面再addtimer，删除的时候删除了回调指针，所以后面回调的时候会报错
- 第一次连接可以成功，而且在超时时间内，也可以发起请求，但是当关闭socket后，就无法再次建立连接了。。。。